version: "3.8"

services:
  tid-web:
    build: .
    ports:
      - "${PORT:-5000}:5000"
    environment:
      - PORT=5000
      - FLASK_DEBUG=${FLASK_DEBUG:-0}
      - SECRET_KEY=${SECRET_KEY:-change-me-in-production}
      - JOB_TIMEOUT=${JOB_TIMEOUT:-3600}
      # ── NASA Earthdata credentials (required for international stations) ──
      # Sign up at: https://urs.earthdata.nasa.gov/users/new
      # Set these in a .env file or export them before running docker compose
      - EARTHDATA_USER=${EARTHDATA_USER:-}
      - EARTHDATA_PASS=${EARTHDATA_PASS:-}
    volumes:
      - tid-output:/app/output
      - tid-logs:/app/logs
      - tid-cache:/tmp/gnss  # laika data cache persists between restarts
    restart: unless-stopped

volumes:
  tid-output:
  tid-logs:
  tid-cache:
